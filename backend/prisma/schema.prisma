// ---------------------------
//  DATABASE CONFIG
// ---------------------------
datasource db {
  provider = "sqlite"          // or "postgresql" for production
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

// ---------------------------
//  MODELS
// ---------------------------

model User {
  id        String   @id @default(cuid())
  name      String
  email     String   @unique
  password  String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  // Relations
  events            Event[]
  sentRequests      SwapRequest[] @relation("RequestorRelation")
  receivedRequests  SwapRequest[] @relation("ResponderRelation")
}

model Event {
  id        String   @id @default(cuid())
  title     String
  startTime DateTime
  endTime   DateTime
  status    String   @default("BUSY")
  ownerId   String
  createdAt DateTime @default(now())

  owner     User @relation(fields: [ownerId], references: [id])

  // Relations with SwapRequests
  mySwapRequests    SwapRequest[] @relation("MySlotRelation")
  theirSwapRequests SwapRequest[] @relation("TheirSlotRelation")
}

model SwapRequest {
  id           String   @id @default(cuid())
  mySlotId     String
  theirSlotId  String
  requestorId  String
  responderId  String
  status       String   @default("PENDING")
  createdAt    DateTime @default(now())

  // Relations
  mySlot     Event @relation("MySlotRelation", fields: [mySlotId], references: [id])
  theirSlot  Event @relation("TheirSlotRelation", fields: [theirSlotId], references: [id])
  requestor  User  @relation("RequestorRelation", fields: [requestorId], references: [id])
  responder  User  @relation("ResponderRelation", fields: [responderId], references: [id])
}
